pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste(Freq,'\n',YearPct,'%')),
position = position_stack(vjust = 0.5),
size=4,
color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
# geom_text(aes(label = paste(Freq,'\n',YearPct,'%')),
#           position = position_stack(vjust = 0.5),
#           size=4,
#           color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
fig1a_YearNum
colnames(fig1a_YearNum) <- c('YearNum','VisitType','Freq','YearTotal')
fig1a_YearNum$YearPct <- round(fig1a_YearNum$Freq / fig1a_YearNum$YearTotal *100, 1)
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
# geom_text(aes(label = paste(Freq,'\n',YearPct,'%')),
#           position = position_stack(vjust = 0.5),
#           size=4,
#           color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste(Freq,'\n',YearPct,'%')),
position = position_stack(vjust = 0.5),
size=4,
color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste(Freq,'\n',YearPct,'%')),
position = position_stack(vjust = 0.5),
size=3,
color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste(Freq,'(',YearPct,'%)')),
position = position_stack(vjust = 0.5),
size=3,
color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste0(Freq,' (',YearPct,'%)')),
position = position_stack(vjust = 0.5),
size=3,
color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste0(Freq,' (',YearPct,'%)')),
position = position_stack(vjust = 0.5),
size=4,
color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste0(Freq,' (',YearPct,'%)')),
position = position_stack(vjust = 0.5),
size=3.5,
color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
fig1a_YearNum$YearPct <- round(fig1a_YearNum$Freq / fig1a_YearNum$YearTotal *100, 0)
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste0(Freq,' (',YearPct,'%)')),
position = position_stack(vjust = 0.5),
size=3.5,
color='white') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste0(Freq,' (',YearPct,'%)')),
position = position_stack(vjust = 0.5),
size=3.5,
color='white',
fontface='bold') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
head(dx)
head(demo)
table(demo$State)
data.frame(table(demo$State))
as.data.frame(sort(table(demo$State), decreasing=TRUE))
as.data.frame(sort(table(demo$State[which(demo$State != 'fo'),]), decreasing=TRUE))
demo$State[which(demo$State != 'fo'),]
demo$State[,which(demo$State != 'fo')]
demo$State[demo$State !='fo']
as.data.frame(sort(table(demo$State[which(demo$State != 'fo')]), decreasing=TRUE))
state <- as.data.frame(sort(table(demo$State[which(demo$State != 'fo')]), decreasing=TRUE))
state$agg <- c(1, rep(0,29))
state
colnames(state) <- c('State','Freq','agg')
state
aggregate(Freq ~ agg, data=state, FUN=sum)
165/(574+165)
dx <- read.csv('ECC_diagnoses.csv')
dx <- read.csv('ECC_diagnoses.csv')
dx$PriDx[which(dx$PriDx == 'Beckwith-Wiedemann\xcasyndrome')] <- 'Beckwith-Wiedemann syndrome'
dx$DxType <- 'NA'
dx$DxType[which(dx$Imprinting == 1)] <- 'Imprinting'
dx$DxType[which(dx$MDEM == 1)] <- 'MDEM'
dx$DxType[which((dx$PriDx == 'Undiagnosed') |
(dx$PriDx == 'Variant of unknown significance'))] <- 'Undiagnosed'
dx$DxType[which(dx$PriDx == 'None')] <- 'None'
dx$DxType[which(dx$DxType == 'NA')] <- 'Non-epigenetic'
dx$State
state <- as.data.frame(sort(table(dx$State[which(dx$State != 'fo')]), decreasing=TRUE))
state
state$agg <- c(1, rep(0,29))
colnames(state) <- c('State','Freq','agg')
aggregate(Freq ~ agg, data=state, FUN=sum)
114/(114+316)
116/(116+316)
head(dexp())
head(dx)
table(dx$Race)
table(dx$Ethnicity)
table(dx$Language)
dx <- read.csv('ECC_diagnoses.csv')
dx$PriDx[which(dx$PriDx == 'Beckwith-Wiedemann\xcasyndrome')] <- 'Beckwith-Wiedemann syndrome'
dx$DxType <- 'NA'
dx$DxType[which(dx$Imprinting == 1)] <- 'Imprinting'
dx$DxType[which(dx$MDEM == 1)] <- 'MDEM'
dx$DxType[which((dx$PriDx == 'Undiagnosed') |
(dx$PriDx == 'Variant of unknown significance'))] <- 'Undiagnosed'
dx$DxType[which(dx$PriDx == 'None')] <- 'None'
dx$DxType[which(dx$DxType == 'NA')] <- 'Non-epigenetic' # This must be last to capture all other diagnoses
table(dx$Language)
64/432
274/432
29/432
30/432
22+42
64/432
63.4+14.8+6.9+14.8
39/432
table(dx$Language)
401/432
18/432
39/432
30/432
18/432
fig3a <- as.data.frame(table(dx$DxType))
colnames(fig3a) <- c('Diagnosis','Freq')
ggplot(fig3a, aes(x="", y=Freq, fill=Diagnosis)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
geom_text(aes(label = paste(Freq, '\n', round(Freq / sum(Freq) * 100, 1), "%"), x = 1.3),
position = position_stack(vjust = 0.5),
size=4,
color='black') +
scale_fill_manual(values=c('#C31407','#609FFF','#F9DE46','#A234F3','#A0E9F9')) +
theme_void() +
theme(legend.text = element_text(size=13),
legend.title = element_text(size=16))
fig3a <- as.data.frame(table(dx$DxType))
colnames(fig3a) <- c('Diagnosis','Freq')
ggplot(fig3a, aes(x="", y=Freq, fill=Diagnosis)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
geom_text(aes(label = paste(Freq, '\n', round(Freq / sum(Freq) * 100, 1), "%"), x = 1.3),
position = position_stack(vjust = 0.5),
size=4,
color='black') +
scale_fill_manual(values=c('#C31407','#609FFF','#F9DE46','#A234F3','#A0E9F9')) +
theme_void() +
theme(legend.text = element_text(size=13),
legend.title = element_text(size=16))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste0(Freq,' (',YearPct,'%)')),
position = position_stack(vjust = 0.5),
size=3.5,
color='white',
fontface='bold') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
table(dx$PriDx[dx$Epigenetic==1])
data.frame(table(dx$PriDx[dx$Epigenetic==1]))
fig3a <- as.data.frame(table(dx$DxType))
colnames(fig3a) <- c('Diagnosis','Freq')
ggplot(fig3a, aes(x="", y=Freq, fill=Diagnosis)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
geom_text(aes(label = paste(Freq, '\n', round(Freq / sum(Freq) * 100, 1), "%"), x = 1.3),
position = position_stack(vjust = 0.5),
size=4,
color='black') +
scale_fill_manual(values=c('#C31407','#609FFF','#F9DE46','#A234F3','#A0E9F9')) +
theme_void() +
theme(legend.text = element_text(size=13),
legend.title = element_text(size=16))
ggplot(data=fig1a_YearNum, aes(x=YearNum, y=Freq, fill=factor(VisitType, levels=c('video return','followup','video new','new')))) +
geom_bar(stat='identity') +
theme_minimal(base_size = 17) +
scale_fill_manual(values=c('#609FFF','#609FFF','#C31407','#C31407')) +
geom_col_pattern(pattern=c('none','none',
'none','none',
'none','none',
'none','none','stripe','stripe',
'none','none','stripe','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.02,
pattern_density=.3) +
geom_text(aes(label = paste0(Freq,' (',YearPct,'%)')),
position = position_stack(vjust = 0.5),
size=3.5,
color='white',
fontface='bold') +
labs(fill='Visit type') +
guides(fill=guide_legend(reverse=TRUE,
override.aes =
list(
pattern=c('none','stripe','none','stripe'),
pattern_fill='black',
pattern_colour='black',
pattern_size=.1,
pattern_spacing=.015,
pattern_density=.3
)))
setwd("~/Desktop/temp/Fahrner lab/Data/Weaver/fahrner_weaver/RNAseq")
library(TxDb.Mmusculus.UCSC.mm10.ensGene)
library(tximport)
library(DESeq2)
library(sva)
library(biomaRt)
library(ggplot2)
library(ggrepel)
library(tximeta)
library(SummarizedExperiment)
library(edgeR)
library(limma)
library(statmod)
library(tidyverse)
### BEGIN LEANDROS' IMPORT
files <- paste0("~/Desktop/temp/Fahrner lab/Data/Weaver/fahrner_weaver/RNAseq/quants_Leandros/",
list.files("quants_Leandros"), "/quant.sf")
names(files) <- c("mut_1-1", "mut_1-2",
"wt_1-1", "wt_1-2",
"mut_2-1", "mut_2-2",
"mut_3-1", "mut_3-2",
"wt_2-1", "wt_2-2",
"wt_3-1", "wt_3-2",
"wt_4-1", "wt_4-2",
"mut_4-1", "mut_4-2",
"mut_5-1", "mut_5-2",
"wt_5-1", "wt_5-2",
"mut_6-1", "mut_6-2")
# creates dataframe w/ tx ID and corresponding gene ID
txdb <- TxDb.Mmusculus.UCSC.mm10.ensGene
k <- keys(txdb, keytype = "GENEID")
df <- select(txdb, keys = k, keytype = "GENEID", columns = "TXNAME")
